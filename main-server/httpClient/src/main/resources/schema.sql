DROP TABLE IF EXISTS EVENTS;
DROP TABLE IF EXISTS USERS;
DROP TABLE IF EXISTS CATEGORIES;
DROP TABLE IF EXISTS LOCATIONS;

CREATE TABLE IF NOT EXISTS USERS
(
    ID    BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
    NAME  CHARACTER VARYING                       NOT NULL,
    EMAIL CHARACTER VARYING                       NOT NULL,
    CONSTRAINT UN_EMAIL UNIQUE (EMAIL),
    CONSTRAINT USERS_PK
        PRIMARY KEY (ID)
);

CREATE TABLE IF NOT EXISTS CATEGORIES
(
    ID   BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
    NAME CHARACTER VARYING                       NOT NULL,
    CONSTRAINT UN_NAME UNIQUE (NAME),
    CONSTRAINT CATEGORIES_PK
        PRIMARY KEY (ID)
);

CREATE TABLE IF NOT EXISTS LOCATIONS
(
    ID  BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    LAT FLOAT NOT NULL,
    LON FLOAT NOT NULL,
    CONSTRAINT LOCATIONS_PK
        PRIMARY KEY (ID)
);

CREATE TABLE IF NOT EXISTS EVENTS
(
    ID                 BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    ANNOTATION         VARCHAR   NOT NULL,
    CREATED_ON         TIMESTAMP,
    DESCRIPTION        VARCHAR   NOT NULL,
    EVENT_DATE         TIMESTAMP NOT NULL,
    PAID               BOOLEAN,
    PARTICIPANT_LIMIT  INT,
    REQUEST_MODERATION BOOLEAN,
    TITLE              VARCHAR,
    CATEGORY           BIGINT    NOT NULL,
    INITIATOR          BIGINT    NOT NULL,
    LOCATION           BIGINT    NOT NULL,

    CONSTRAINT EVENTS_PK
        PRIMARY KEY (ID),
    CONSTRAINT LOCATION_FK
        FOREIGN KEY (LOCATION) REFERENCES LOCATIONS,
    CONSTRAINT CATEGORY_FK
        FOREIGN KEY (CATEGORY) REFERENCES CATEGORIES,
    CONSTRAINT INITIATOR_FK
        FOREIGN KEY (INITIATOR) REFERENCES USERS
);